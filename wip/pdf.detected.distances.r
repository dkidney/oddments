############################################################################################################################################################################
############################################################################################################################################################################

pdf.detected.distances <- function(distance, detectfn, detectpar, density, buffer){
    
    f = function(distance, detectfn, detectpar) return(detection.probability(distance, detectfn, detectpar) * distance)
        
    integral <- integrate(f, detectfn=detectfn, detectpar=detectpar, lower = 0, upper = buffer)$value
    
    return(f(distance, detectfn, detectpar) / integral)
    
}

############################################################################################################################################################################
############################################################################################################################################################################
